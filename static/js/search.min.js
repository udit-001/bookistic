function getCookie(e){for(var t=e+"=",n=decodeURIComponent(document.cookie),r=n.split(";"),o=0;o<r.length;o++){for(var l=r[o];" "==l.charAt(0);)l=l.substring(1);if(0==l.indexOf(t))return l.substring(t.length,l.length)}return""}pencilHover();var loadMore=function(){const e=document.querySelector('input[name="order"]:checked').value,t=localStorage.getItem("query"),n=new XMLHttpRequest;resultContainer=document.querySelector("#resultContainer"),n.open("POST","/fetch"),n.setRequestHeader("Cache-Control","no-cache");var r=getCookie("_csrf_token");n.setRequestHeader("X-CSRFToken",r),n.onreadystatechange=function(){try{if(n.readyState===XMLHttpRequest.DONE)if(200===n.status){const e=JSON.parse(n.responseText);if(e.results.length>0){for(document.querySelector(".loadMore")&&document.querySelector("#resultContainer").removeChild(document.querySelector(".loadMore")),i=0;i<e.results.length;i++)a=document.createElement("a"),a.setAttribute("href","../book/"+e.results[i][0]),a.setAttribute("target","_blank"),resultItem=document.createElement("div"),resultItem.setAttribute("class","resultItem"),h2=document.createElement("h2"),h2.innerText=e.results[i][1],resultItem.appendChild(h2),p=document.createElement("p"),p.innerHTML=`By <strong>${e.results[i][2]}</strong>`,resultItem.appendChild(p),p2=document.createElement("p"),p2.innerHTML=`ISBN : <strong>${e.results[i][3]}</strong>`,resultItem.append(p2),a.appendChild(resultItem),resultContainer.appendChild(a);load=document.createElement("div"),load.setAttribute("class","loadMore"),load.innerHTML="<h2>Load More</h2>",load.addEventListener("click",loadMore),resultContainer.appendChild(load)}else document.querySelector(".loadMore").remove()}else console.log("There was a problem with the request");else n.readyState===XMLHttpRequest.LOADING&&console.log("loading...")}catch(e){console.log(e)}};const o=new FormData;o.append("query",t),o.append("order",e),o.append("offset",resultContainer.children.length),n.send(o)};document.addEventListener("DOMContentLoaded",function(){document.querySelector("#search-form").onsubmit=function(e){e.preventDefault()},document.querySelector("#submit").onclick=function(){const e=document.querySelector('input[name="order"]:checked').value,t=document.querySelector("#query").value;localStorage.setItem("query",t);try{search=document.querySelector(".SearchTitle"),document.body.removeChild(search),results=document.querySelector("#resultContainer"),document.body.removeChild(results)}catch(e){console.log(e)}const n=new XMLHttpRequest;n.open("POST","/fetch");var r=getCookie("_csrf_token");n.setRequestHeader("X-CSRFToken",r),n.onreadystatechange=function(){try{if(n.readyState===XMLHttpRequest.DONE)if(200===n.status){const e=JSON.parse(n.responseText);if(e.results.length>0){for(document.querySelector(".SearchContainer").insertAdjacentHTML("afterend","<div class='SearchTitle'><h2>Search Results are...</h2></div><div id='resultContainer'></div>"),document.querySelector(".spinner")&&document.body.removeChild(document.querySelector(".spinner")),document.querySelector(".notFound")&&document.body.removeChild(document.querySelector(".notFound")),resultContainer=document.querySelector("#resultContainer"),i=0;i<e.results.length;i++)a=document.createElement("a"),a.setAttribute("href","../book/"+e.results[i][0]),a.setAttribute("target","_blank"),resultItem=document.createElement("div"),resultItem.setAttribute("class","resultItem"),h2=document.createElement("h2"),h2.innerText=e.results[i][1],resultItem.appendChild(h2),p=document.createElement("p"),p.innerHTML=`By <strong>${e.results[i][2]}</strong>`,resultItem.appendChild(p),p2=document.createElement("p"),p2.innerHTML=`ISBN : <strong>${e.results[i][3]}</strong>`,resultItem.append(p2),a.appendChild(resultItem),resultContainer.appendChild(a);load=document.createElement("div"),load.setAttribute("class","loadMore"),load.innerHTML="<h2>Load More</h2>",load.addEventListener("click",loadMore),console.log(load),resultContainer.appendChild(load)}else document.querySelector(".spinner")&&document.body.removeChild(document.querySelector(".spinner")),document.querySelector(".notFound")&&document.body.removeChild(document.querySelector(".notFound")),document.querySelector(".SearchContainer").insertAdjacentHTML("afterend","<div class='notFound'><h2>No results found!</h2></div>")}else console.log("There was a problem with the request")}catch(e){console.log(e)}};const o=new FormData;o.append("query",t),o.append("order",e),console.log("Sending request"),n.send(o),document.querySelector(".notFound")&&document.body.removeChild(document.querySelector(".notFound")),document.querySelector(".SearchContainer").insertAdjacentHTML("afterend",'<div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>')}});